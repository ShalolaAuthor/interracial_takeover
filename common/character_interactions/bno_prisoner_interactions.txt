bno_prisoner_interaction = {
    interface_priority = 999
    icon = icon_bno_prisoner_interaction

    category = interaction_category_prison
    desc = {
        first_valid = {
            triggered_desc = {
                trigger = { scope:recipient = { is_male = yes } }
                desc = bno_prisoner_interaction_desc
            }
            triggered_desc = {
                trigger = { scope:recipient = { is_a_futa = yes } }
                desc = bno_prisoner_interaction_desc.futa
            }
            desc = bno_prisoner_interaction_desc.female
        }
    }

    common_interaction = yes

    is_shown = {
        bno_prisoner_interaction_trigger = yes
    }

    is_valid_showing_failures_only = {
        scope:recipient = {
            NOT = { has_trait = bno_castrated }
            NOT = { has_trait = bno_castrated_futa }
            NOT = { has_trait = bno_slave }
        }
        scope:actor = {
            trigger_if = {
                limit = { is_a_girl = yes }
                custom_tooltip = {
                    text = bno_prisoner_interaction.has_bbc_in_court
                    bno_is_there_any_bbc_in_the_court_trigger = yes
                }
            }
        }
    }

    is_highlighted = {
        always = yes
    }

    send_option = {
        is_shown = {
            bno_male_prisoner_interaction_trigger = yes
        }
        is_valid = {
            scope:actor = {
                has_chastity_cage_artifact = yes
            }
            scope:recipient = {
                custom_tooltip = {
                    text = bno_prisoner_interaction.not_caged
                    NOT = { has_trait = bno_caged }
                    NOT = { has_trait = bno_caged_futa }
                }
            }
        }
        flag = bno_prisoner_interaction_caging
        localization = bno_prisoner_interaction.caging
    }
    send_option = {
        is_shown = {
            bno_male_prisoner_interaction_trigger = yes
        }
        is_valid = {
            scope:actor = {
                has_tincture_of_genesis_artifact = yes
            }
            scope:recipient = {
                custom_tooltip = {
                    text = bno_prisoner_interaction.not_castrated
                    OR = {
                        NOT = { has_trait = bno_castrated }
                        NOT = { has_trait = bno_castrated_futa }
                    }
                }
            }
        }
        flag = bno_prisoner_interaction_castrating
        localization = bno_prisoner_interaction.castrating
    }
    send_option = {
        is_shown = {
            bno_female_prisoner_interaction_trigger = yes
        }
        is_valid = {
            scope:recipient = {
                NOT = { has_trait = bno_slave }
            }
            scope:actor = {
                trigger_if = {
                    limit = {
                        is_bbc = yes
                    }
                    always = yes
                }
                trigger_else = {
                    custom_tooltip = {
                        text = bno_prisoner_interaction.has_bbc_in_court
                        bno_is_there_any_bbc_in_the_court_trigger = yes
                    }
                }
            }
        }
        flag = bno_prisoner_interaction_slaving
        localization = bno_prisoner_interaction.slaving
    }
    on_accept = {
        if = {
            limit = { scope:bno_prisoner_interaction_caging = yes }
            bno_cage_prisoner_trait_maintenance_option = yes
        }
        else_if = {
            limit = { scope:bno_prisoner_interaction_castrating = yes }
            bno_castrate_prisoner_option = yes
        }
        else_if = {
            limit = { scope:bno_prisoner_interaction_slaving = yes }
            bno_enslave_prisoner_option = yes
        }
        bno_recruit_prisoner_effect = yes
    }

    auto_accept = yes
}