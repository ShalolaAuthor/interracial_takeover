bno_offer_tribute = {
    skill = stewardship
    category = personal
    target_type = character
    illustration = "gfx/interface/illustrations/event_scenes/corridor.dds"
    success_desc = bno_offer_tribute.success_desc
    desc = bno_offer_tribute_desc
    is_secret = no

    is_basic = yes

    speed_per_skill_point = -3
    speed_per_target_skill_point = 1
    base_progress_goal = 50
    phases_per_agent_charge = 1
    success_chance_growth_per_skill_point = t3_scgpsp_value
    
    base_maximum_success = 100
    
    base_success_chance = {
        base = 100
    }

    allow = {
        is_culture_bnoc = yes
        is_adult = yes
        is_playable_character = yes
        is_imprisoned = no
    }

    valid = {
        is_playable_character = yes
        is_ruler = yes
        is_incapable = no
        is_bbc = no
        is_culture_bnoc = yes
        OR = {
            is_bno_snowbunny_and_up = yes
            is_bno_cuck_and_up = yes
        }
        scope:target = {
            is_imprisoned = no
            is_bbc = yes
            is_ruler = yes
            is_adult = yes
        }
        scope:owner.var:bno_tribute = {
            is_alive = yes
            is_a_girl = yes
            is_adult = yes
        }
    }

    on_start = {
        save_scope_as = scheme
        scheme_owner = { save_scope_as = owner }
        scheme_target_character = { save_scope_as = target }
        scope:owner.var:bno_tribute = { save_scope_as = tribute }
        scope:tribute = {
            create_character_memory = {
                type = bno_offer_tribute_training_started
                participants = {
                    scheme_owner = scope:owner
                    target = scope:target
                }
            }
        }
        scope:owner = {
            create_character_memory = {
                type = bno_offer_tribute_daughter_training_started
                participants = {
                    target = scope:target
                    tribute = scope:tribute
                }
            }
            trigger_event = {
                id = bno_offer_tribute.0001
            }
        }
    }

    on_monthly = {
        save_scope_as = scheme
        scheme_owner = { save_scope_as = owner }
        scheme_target_character = { save_scope_as = target }
        var:bno_tribute = { save_scope_as = tribute }

        #Phase 1
        if = {
            limit = {
                scheme_progress <= bno_scheme_progress_40
                scheme_owner = {
                    is_available = yes
                }
                scope:tribute = {
                    is_available = yes
                }
            }
            scope:owner = {
                trigger_event = { on_action = bno_offer_tribute_phase_1 }
            }
        }
        #Phase 2
        else_if = {
            limit = {
                scheme_progress <= bno_scheme_progress_80
                scheme_progress > bno_scheme_progress_40
                scheme_owner = {
                    is_available = yes
                }
                scope:tribute = {
                    is_available = yes
                }
            }
            scope:owner = {
                trigger_event = { on_action = bno_offer_tribute_phase_2 }
            }
        }
        #Phase 3
        else_if = {
            limit = {
                scheme_progress > bno_scheme_progress_80
                scheme_owner = {
                    is_available = yes
                }
                scope:tribute = {
                    is_available = yes
                }
            }
            scope:owner = {
                trigger_event = { on_action = bno_offer_tribute_phase_3 }
            }
        }
    }

    on_phase_completed = {
        save_scope_as = scheme
        scheme_target_character = {
            save_scope_as = target
        }
        scheme_owner = {
            save_scope_as = owner
        }
        var:bno_tribute = {
            save_scope_as = tribute
        }

        scope:tribute.var:story_bno_tribute_training.var:bno_trainer = {
            save_scope_as = trainer
        }

        if = {
            limit = {
                exists = scope:trainer
            }
            scope:owner = {
                trigger_event = bno_offer_tribute.4000
            }
        }       
    }

    on_invalidated = {
        save_scope_as = scheme
        scheme_target_character = {
            save_scope_as = target
        }
        scheme_owner = {
            save_scope_as = owner
        }
        var:bno_tribute = {
            save_scope_as = tribute
        }

        scope:tribute = {
            var:story_bno_tribute_training = {
                end_story = yes
            }
        }

        if = {
            limit = {
                scope:tribute = { is_alive = no }
            }
            scope:owner = {
                send_interface_message = {
                    type = bno_blacked_events
                    title = bno_offer_tribute.invalidated.title.tribute.died
                    desc = bno_offer_tribute.invalidated.desc.tribute.died
                    scope:scheme = { end_scheme = yes }
                }
            }
        }
        if = {
            limit = {
                scope:target = { is_alive = no }
            }
            scope:owner = {
                send_interface_message = {
                    type = bno_blacked_events
                    title = bno_offer_tribute.invalidated.title.target.died
                    desc = bno_offer_tribute.invalidated.desc.target.died
                    scope:scheme = { end_scheme = yes }
                }
            }
        }
        if = {
            limit = {
                scope:target = { is_imprisoned = yes }
            }
            scope:owner = {
                send_interface_message = {
                    type = bno_blacked_events
                    title = bno_offer_tribute.invalidated.title.target.imprisoned
                    desc = bno_offer_tribute.invalidated.desc.target.imprisoned
                    scope:scheme = { end_scheme = yes }
                }
            }
        }
    }
}