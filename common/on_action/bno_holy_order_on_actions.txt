on_title_gain = {
    on_actions = {
        bno_on_title_gain
    }
}

on_title_gain_inheritance = {
    on_actions = {
        bno_on_title_gain
    }
}

on_title_gain_usurpation = {
    on_actions = {
        bno_on_title_gain
    }
}

bno_on_title_gain = {
    trigger = {
        scope:title = {
            has_variable = bbc_holy_order
        }
    }
    effect = {
        if = {
            limit = {
                NOT = { has_trait = bno_whitegirl }
            }
            create_blacked_european_girls = {
                TEMPLATE = bno_female_holy_order_leader_character_template
                LOCATION = location
                SCOPE = leader
            }
            create_title_and_vassal_change = {
                type = granted
                save_scope_as = change
                add_claim_on_loss = no
            }
            scope:title = {
                change_title_holder = {
                    holder = scope:leader
                    change = scope:change
                    take_baronies = yes
                }
            }
            death = {
				death_reason = death_vanished
			}
        }
    }
}

on_join_court = {
    on_actions = {
        bno_on_join_court
    }
}

bno_on_join_court = {
    trigger = {
        liege.primary_title ?= {
            has_variable = bbc_holy_order
        }
    }
    effect = {
        if = {
            limit = {
                is_a_male = yes
            }            
            death = {
		    	death_reason = death_vanished
		    }
            if = {
                limit = {
                    scope:new_employer = {
                        any_courtier_or_guest = {
                            has_trait = bno_whitegirl
                            count < 5
                        }
                    }
                }
                create_blacked_european_girls = {
                    TEMPLATE = bno_female_holy_order_leader_character_template
                    LOCATION = root.location
                    SCOPE = female_courtier
                }
                scope:new_employer = {
                    add_courtier = scope:female_courtier
                }
            }
        }
    }
}

#yearly_global_pulse = {
#    on_actions = {
#        bno_send_letter_pulse
#    }
#}
#bno_send_letter_pulse = {
#    on_actions = {
#        delay = { days = { 1 89 } }
#        bno_send_priestess
#        delay = { days = { 90 179 } }
#        bno_send_priestess
#        delay = { days = { 180 269 } }
#        bno_send_priestess
#        delay = { days = { 270 365 } }
#        bno_send_priestess
#    }
#}

#bno_send_priestess = {
#    trigger = {
#        any_religion_global = {
#            any_faith = {
#                religion_tag = bnonr_religion
#                any_faith_holy_order = {
#                    has_variable = bbc_holy_order
#                }
#            }
#        }
#    }
#    effect = {
#        every_religion_global = {
#            every_faith = {
#                limit = {
#                    religion_tag = bnonr_religion
#                }
#                random_faith_holy_order = {
#                    limit = {
#                        has_variable = bbc_holy_order
#                    }
#                    holy_order_patron = {
#                        trigger_event = bno_embrace_african_5.0007
#                    }
#                }
#            }
#        }
#    }
#}