namespace = bno_character_initialization

bno_character_initialization.0001 = {
	scope = none
	hidden = yes
	immediate = {
		every_living_character = {
			limit = {
				is_alive = yes
			}
			trigger_event = { on_action = bno_trait_initialization_pulse }
		}
	}
}

namespace = bno_trait_seeding

#African Traits
bno_trait_seeding.0001 = {
	hidden = yes
	trigger = {
		is_alive = yes
	}
	immediate = {
		if = {
			limit = {
				NOT = { has_character_flag = bno_traits_seeded }
			}
			add_character_flag = bno_traits_seeded
			if = {
				limit = {
					NOT = { has_trait = bno_blood }
					bno_is_graphically_african = yes
				}
				add_trait = bno_full_black
				bno_seed_originally_african_flag = yes
			}
			else_if = {
				limit = {
					NOT = { exists = mother }
					is_african = yes
				}
				bno_seed_originally_african_flag = yes
			}
		}
		trigger_event = bno_trait_seeding.0002
	}
}
# BBC Traits
bno_trait_seeding.0002 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				NOT = { has_character_flag = bno_bbc_trait_seeded }
			}
			bno_seed_bbc_trait_effect = yes
			bno_futa_bisexual = yes
		}
		trigger_event = bno_trait_seeding.0003
	}
}
# Make BBC Trait not active if female
bno_trait_seeding.0003 = {
	hidden = yes
	immediate = {
		bno_make_bbc_trait_inactive = yes
		trigger_event = bno_trait_seeding.0004
	}
}
# Pussy Mileage Seeding
bno_trait_seeding.0004 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				NOT = { has_character_flag = bno_pussy_mileage_trait_seeded }
			}
			add_character_flag = bno_pussy_mileage_trait_seeded
			if = {
				limit = {
					is_female = yes
					NOT = { has_trait = bno_pussy_mileage }
				}
				add_trait = bno_pussy_mileage_1
			}
			if = {
				limit = {
					is_female = yes
					is_married = yes
					any_spouse = {
						is_bbc = yes
					}
				}
				change_trait_rank = {
					trait = bno_pussy_mileage
					rank = 1
				}
				add_trait_xp = {
					trait = bno_pussy_mileage_2
					value = bno_random_xp_positive
				}
			}
			if = {
				limit = {
					is_female = yes
					any_child = {
						count >= 1
					}
				}
				every_child = {
					root = {
						add_trait_xp = {
							trait = bno_pussy_mileage_1
							value = bno_random_xp_positive
						}
					}
				}
			}
		}
		trigger_event = bno_trait_seeding.0005
	}
}
#Seed all character with body trait
bno_trait_seeding.0005 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				NOT = { has_character_flag = bno_body_traits_seeded }
				has_character_flag = carn_dt_traits_seeded
			}
			add_character_flag = bno_body_traits_seeded
			if = {
				limit = {
					is_female = yes
				}
				bno_lottery_tits_size = yes
			}
			if = {
				limit = {
					is_a_male = yes
					is_bbc = no
				}
				bno_lottery_dick_size = yes
			}
			if = {
				limit = {
					is_a_male = yes
					is_bbc = yes
				}
				bno_make_bbc_has_big_dick = yes
			}
		}
		trigger_event = bno_trait_seeding.0006
	}
}
#remove BBC from non african
bno_trait_seeding.0006 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				is_bbc = yes
				NOT = { has_trait = bno_blood }
			}
			remove_trait = bno_bbc
		}
		trigger_event = bno_trait_seeding.0007
	}
}
# add breast size variable
bno_trait_seeding.0007 = {
	hidden = yes
	immediate = {
		bno_seed_breast_size_variable = yes
		trigger_event = bno_trait_seeding.0008
	}
}
# convert bbc people to have african culture
bno_trait_seeding.0008 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				is_bbc = yes
				is_ai = yes
				is_culture_bnoc = no
				has_game_rule = bno_bbc_forced_conversion_yes
			}
			if = {
				limit = {
					liege ?= {
						is_culture_bnoc = yes
					}
				}
				set_culture = liege.culture
			}
			else = {
				set_culture = culture:bnoc
			}
		}
		trigger_event = bno_trait_seeding.0009
	}
}
# convert bbc people to church of the black cock
bno_trait_seeding.0009 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				is_bbc = yes
				is_ai = yes
				is_faith_bbcs = no
				has_game_rule = bno_religion_yes
				has_game_rule = bno_bbc_forced_conversion_yes
			}
			if = {
				limit = {
					liege ?= {
						is_faith_bbcs = yes
					}
				}
				set_character_faith_with_conversion = liege.faith
			}
			else = {
				set_character_faith_with_conversion = faith:bbcs
			}
		}
		trigger_event = bno_trait_seeding.0010
	}
}
# if liege is from Church of the Black Cock convert vassal into liege faith
bno_trait_seeding.0010 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				faith = faith:bbcs
				trigger_if = {
					limit = {
						exists = liege
						liege ?= {
							is_faith_bbcs = yes
						}
						NOT = { faith = liege.faith }
					}
					always = yes
				}
				trigger_else = {
					always = no
				}
			}
			set_character_faith_with_conversion = liege.faith
		}
		trigger_event = bno_trait_seeding.0011
	}
}
# if slut cant have futa
bno_trait_seeding.0011 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				is_a_futa = yes
				is_slut = yes
			}
			bno_make_futa_inactive = yes
		}
	}
}