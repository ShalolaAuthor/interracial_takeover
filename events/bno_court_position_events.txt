namespace = bbc_worshipper

bbc_worshipper.0001 = {
    hidden = yes

    trigger = {
        NOT = { has_character_flag = bbc_worshipper.1001 }
    }

    immediate = {
        trigger_event = {
            id = bbc_worshipper.1001
            days = 2
            delayed = yes
        }
        add_character_flag = { flag = bbc_worshipper.1001 }
    }
}

bbc_worshipper.1001 = {
    hidden = yes
    
    trigger = {
        has_character_flag = bbc_worshipper.1001
    }

    immediate = {
        bbc_worshipper_whoring_around = yes
        trigger_event = {
            id = bbc_worshipper.1001
            months = bno_prostitution_interval
            delayed = yes
        }
        trigger_event = {
            id = bbc_worshipper.0002
            days = 7
            delayed = yes
        }
    }
}

bbc_worshipper.2001 = {
    hidden = yes

    trigger = {
        has_character_flag = bbc_worshipper.1001
    }

    immediate = {
        remove_character_flag = bbc_worshipper.1001
    }
}

bbc_worshipper.0002 = {
    hidden = yes

    trigger = {
        exists = liege
    }

    immediate = {
        liege ?= {
            send_interface_message = {
                type = bno_blacked_events
                title = bbc_worshipper.0002.notifications.title
                right_icon = root
                desc = bbc_worshipper.0002.notifications.desc
                root = {
                    bbc_worshipper_give_all_spoil_to_liege = yes
                }
            }
        }
    }
}

namespace = bbc_priestess

bbc_priestess.0001 = {
    hidden = yes

    trigger = {
        NOT = { has_character_flag = bbc_priestess.1001 }
        is_alive = yes
    }

    immediate = {
        trigger_event = {
            id = bbc_priestess.1001
            days = 2
            delayed = yes
        }
        add_character_flag = bbc_priestess.1001
    }
}

bbc_priestess.1001 = {
    hidden = yes

    trigger = {
        has_character_flag = bbc_priestess.1001
        is_alive = yes
    }

    immediate = {
        trigger_event = {
            id = bbc_priestess.1001
            months = { 6 12 }
            delayed = yes
        }
        
        random_list = {
            80 = { # own realm
                random_list = {
                    80 = { bbc_priestess_convert_vassal = yes }
                    20 = { bbc_priestess_convert_county = yes }
                }
            }
            20 = { # outside realm
                random_list = {
                    80 = { bbc_priestess_convert_neighboring_ruler = yes }
                    20 = { bbc_priestess_convert_neighboring_county = yes }
                }
            }
        }
    }
}

bbc_priestess.2001 = {
    hidden = yes

    trigger = {
        has_character_flag = bbc_priestess.1001
        is_alive = yes
    }

    immediate = {
        remove_character_flag = bbc_priestess.1001
    }
}
# some spawned in people will beg liege to build bbc_church_02
bbc_priestess.0002 = {
    type = character_event
    title = bbc_priestess.0002.title
    desc = bbc_priestess.0002.desc
    theme = realm

    override_background = {
        reference = farmland
    }

    left_portrait = {
        character = root
        animation = thinking
    }

    right_portrait = {
        character = scope:wanderer
        animation = disappointed
    }

    trigger = {
        bno_has_embrace_african_5 = yes
        any_realm_province = {
            has_building = bbc_church_01
        }    
    }

    immediate = {
        create_character = {
            template = bbc_noble_template
            location = root.capital_province
            save_scope_as = wanderer
        }
    }

    option = { # i will think about it
        name = bbc_priestess.0002.a
    }

    after = {
        bno_kill_character = {
            TARGET = scope:wanderer
        }
    }
}

#Please make the holy order
bbc_priestess.0003 = {
    type = character_event
    title = bbc_priestess.0003.title
    desc = bbc_priestess.0003.desc
    theme = realm

    override_background = {
        reference = farmland
    }

    left_portrait = {
        character = root
        animation = thinking
    }

    right_portrait = {
        character = scope:wanderer
        animation = disappointed
    }

    trigger = {
        bno_has_embrace_african_5 = yes
        any_realm_province = {
            has_building = bbc_church_02
        }    
    }

    immediate = {
        random_list = {
            40 = {
                create_blacked_european_girls = {
                    TEMPLATE = bbc_worshipper_low_character_template
                    LOCATION = root.capital_province
                    SCOPE = wanderer
                }
            }
            40 = {
                create_blacked_european_girls = {
                    TEMPLATE = bbc_worshipper_high_character_template
                    LOCATION = root.capital_province
                    SCOPE = wanderer
                }
            }
            20 = {
                create_blacked_european_girls = {
                    TEMPLATE = bbc_worshipper_excellent_character_template
                    LOCATION = root.capital_province
                    SCOPE = wanderer
                }
            }
        }
    }

    option = { # i will think about it
        name = bbc_priestess.0003.a
    }

    after = {
        bno_kill_character = {
            TARGET = scope:wanderer
        }
    }
}

# Found bbc holy order decision
bbc_priestess.0004 = {
    type = character_event
    title = bbc_priestess.0004.title
    desc = bbc_priestess.0004.desc
    theme = realm

    override_background = {
        reference = throne_room
    } 

    left_portrait = {
        character = root
        animation = personality_content
    }

    right_portrait = {
        character = scope:leader
        animation = bno_sex_love_stand_2
        outfit_tags = {
            no_clothes
            no_headgear
        }
    }

    trigger = {
        exists = capital_province
    }

    immediate = {
        #mandatory vanilla shit
        if = {
            limit = { exists = scope:barony }
            hidden_effect = {
                if = {
                    limit = { NOT = { scope:barony.holder = root } }
                    create_title_and_vassal_change = {
                        type = leased_out
                        save_scope_as = change
                        add_claim_on_loss = no
                    }
                    scope:barony = {
                        change_title_holder_include_vassals = {
                            holder = root
                            change = scope:change
                        }
                    }
                    resolve_title_and_vassal_change = scope:change
                }
            }
        }

        create_blacked_european_girls = {
            TEMPLATE = bno_female_holy_order_leader_character_template
            LOCATION = scope:barony.title_province
            SCOPE = leader
        }

        create_holy_order_neutral_effect = {
            LEADER = scope:leader
            CAPITAL = scope:barony
            NEW_HO_SCOPE = new_holy_order
            FOUNDER = root
        }

        create_holy_order_effect = yes

        scope:new_holy_order = {
            set_variable = bbc_holy_order
        }
    }

    option = {
        name = bbc_priestess.0004.a
    }
}

#letter event holy order has sent you a priest
bbc_priestess.0005 = {
    type = letter_event
    sender = scope:order_leader
    opening = {
        desc = bbc_priestess.0005.opening
    }
    desc = bbc_priestess.0005.desc

    trigger = {
        can_employ_court_position_type = bno_bbc_priestess_court_position
        faith = {
            any_faith_holy_order = {
                has_variable = bbc_holy_order
            }
        }
    }

    immediate = {
        faith = {
            every_faith_holy_order = {
                limit = {
                    has_variable = bbc_holy_order
                }
                leader = {
                    save_scope_as = order_leader
                }
            }
        }
        if = {
            limit = {
                is_a_girl = yes
            }
            create_character = {
                template = bno_male_priest_character_template
                location = root.capital_province
                save_scope_as = priest
            }
        }
        else_if = {
            limit = {
                is_a_male = yes
            }
            create_blacked_european_girls = {
                SCOPE = priest
                LOCATION = root.capital_province
                TEMPLATE = bno_female_priest_character_template
            }
        }
    }

    option = {
        name = bbc_priestess.0005.a
        add_courtier = scope:priest
        appoint_court_position = {
            recipient = scope:priest
            court_position = bno_bbc_priestess_court_position
        }
        reverse_add_opinion = {
            target = scope:priest
            modifier = hired_me_opinion
        }
    }

}

#beg liege to make the church foundation
bbc_priestess.0006 = {
    type = character_event
    title = bbc_priestess.0006.title
    desc = bbc_priestess.0006.desc
    theme = realm

    override_background = {
        reference = farmland
    }

    left_portrait = {
        character = root
        animation = thinking
    }

    right_portrait = {
        character = scope:wanderer
        animation = disappointed
    }

    trigger = {
        bno_has_embrace_african_5 = yes
        NAND = {
            any_realm_province = {
                has_building = bbc_church_01
            }    
            any_realm_province = {
                has_building = bbc_church_02
            }  
        }
    }

    immediate = {
        create_character = {
            template = bbc_noble_template
            location = root.capital_province
            save_scope_as = wanderer
        }
    }

    option = { # i will think about it
        name = bbc_priestess.0006.a
    }

    after = {
        bno_kill_character = {
            TARGET = scope:wanderer
        }
    }    
}